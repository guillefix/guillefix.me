<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.1.17" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>Surprisal as a Lyapunov function in stochastic dynamics: Cosmos — Everything there was, there is, and there will be</title>
</head>
<body class="tc-body">

<section class="tc-story-river">

<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists    " data-tags="" data-tiddler-title="Surprisal as a Lyapunov function in stochastic dynamics"><div class="tc-tiddler-title">
<div class="tc-titlebar">
<span class="tc-tiddler-controls">
<span class=" tc-reveal"><button aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span>
</span>

<span>

<span class="tc-tiddler-title-icon" style="fill:;">

</span>



<h2 class="tc-title">
Surprisal as a Lyapunov function in stochastic dynamics
</h2>

</span>

</div>

<div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div>
</div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal">
<div class="tc-subtitle">
<a class="tc-tiddlylink tc-tiddlylink-missing" href="cosmos.html">
cosmos
</a> 23rd November 2016 at 10:00pm
</div>
</div>
<div class=" tc-reveal">
<div class="tc-tags-wrapper"></div>
</div>
<div class="tc-tiddler-body tc-reveal"><p>See <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Free%2520energy%2520principle.html">Free energy principle</a> for context.</p><p>We can describe it using the <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Fokker-Planck%2520equation.html">Fokker-Planck equation</a>. It's steady state solution:</p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>p</mi></mrow><mo>˙</mo></mover><mo>=</mo><mn>0</mn><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo>(</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mo>−</mo><mi>f</mi><mo>)</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\dot{p}=0=\nabla \cdot(\Gamma \nabla - f) p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">p</span></span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>˙</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mord mathit">p</span></span></span></span></span></p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>p</mi><mo>=</mo><mi>p</mi><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>f</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">\nabla \cdot \Gamma \nabla p  = p \nabla \cdot  f + f \cdot \nabla p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span></span></span></span></span></p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>p</mi></mrow><mrow><mi>p</mi></mrow></mfrac><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>f</mi><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∇</mi><mi>p</mi></mrow><mrow><mi>p</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{\nabla \cdot \Gamma \nabla p}{p} = \nabla \cdot  f + f \cdot \frac{\nabla p}{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.924439em;"></span><span class="strut bottom" style="height:1.4055469999999999em;vertical-align:-0.481108em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">⋅</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">∇</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>−</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>p</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo>(</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>p</mi></mrow></mfrac><mo>)</mo><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>f</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex"> \nabla \cdot \Gamma \nabla \ln p - \Gamma \nabla p \cdot \nabla (\frac{1}{p}) = \nabla \cdot  f + f \cdot \nabla \ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">−</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span></p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>+</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mi>p</mi><mn>2</mn></msup></mrow></mfrac><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>p</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>f</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex"> \nabla \cdot \Gamma \nabla \ln p +\frac{1}{p^2} \Gamma \nabla p \cdot \nabla p = \nabla \cdot  f + f \cdot \nabla \ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span></p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>+</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>f</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex"> \nabla \cdot \Gamma \nabla \ln p +\Gamma \nabla \ln p \cdot \nabla \ln p = \nabla \cdot  f + f \cdot \nabla \ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">+</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span></p><p>We can decompose any vector field into an irrotational (curl-free), and solenoidal (divergence-free) component (<a class="tc-tiddlylink tc-tiddlylink-missing" href="Helmholtz%2520decomposition.html">Helmholtz decomposition</a>), which can be expressed as the so-called <em>standard form</em>:</p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mo>(</mo><mi mathvariant="normal">Γ</mi><mo>+</mo><mi>Q</mi><mo>)</mo><mi mathvariant="normal">∇</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">f=(\Gamma + Q) \nabla V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">Γ</span><span class="mbin">+</span><span class="mord mathit">Q</span><span class="mclose">)</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span></p><p>where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span></span></span></span></span> is antisymmetric, and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Γ</span></span></span></span></span> is symmetric. Substituting in above equation</p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>+</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>V</mi><mo>+</mo><mo>(</mo><mi mathvariant="normal">Γ</mi><mo>+</mo><mi>Q</mi><mo>)</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex"> \nabla \cdot \Gamma \nabla \ln p +\Gamma \nabla \ln p \cdot \nabla \ln p = \nabla \cdot  \Gamma \nabla V + (\Gamma + Q) \nabla V\cdot \nabla \ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">+</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">Γ</span><span class="mbin">+</span><span class="mord mathit">Q</span><span class="mclose">)</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span></p><p>Notice that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi mathvariant="normal">Γ</mi><mo>+</mo><mi>Q</mi><mo>)</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><msup><mi>V</mi><mi>T</mi></msup><mo>(</mo><mi mathvariant="normal">Γ</mi><mo>+</mo><mi>Q</mi><mo>)</mo><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi><mo>=</mo><mi mathvariant="normal">∇</mi><msup><mi>V</mi><mi>T</mi></msup><mi mathvariant="normal">Γ</mi><mi mathvariant="normal">∇</mi><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">(\Gamma + Q) \nabla V\cdot \nabla \ln p = \nabla V ^T (\Gamma + Q)  \nabla \ln p = \nabla V ^T \Gamma\nabla \ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">Γ</span><span class="mbin">+</span><span class="mord mathit">Q</span><span class="mclose">)</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathrm">Γ</span><span class="mbin">+</span><span class="mord mathit">Q</span><span class="mclose">)</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">Γ</span><span class="mord mathrm">∇</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span> because <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span></span></span></span></span> is antisymmetric. Using this, if we assume that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>=</mo><mi>ln</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">V=\ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mop">ln</span><span class="mord mathit">p</span></span></span></span></span>, then the above equation for stationarity is satisfied.</p><p><u>Proof from paper</u>: see <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Free_energy_principle_lemmaD1a.png.html">Free_energy_principle_lemmaD1a.png</a> and <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Free_energy_principle_lemmaD1b.png.html">Free_energy_principle_lemmaD1b.png</a></p><p>It is straight-forward but fundamental result means that the flow of any ergodic random dynamical system can be expressed in terms of orthogonal curl- and divergence-free components, where the (dissipative) curl-free part increases value while the (con-servative) divergence-free part follows isoprobability con-tours and does not change value. Crucially, under this decomposition value is simply negative surprise: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ln</mi><mi>p</mi><mo>(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo><mo>=</mo><mi>V</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mo>−</mo><mi>L</mi><mo>(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\ln p(x|m)= V(x) = -L(x|m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mop">ln</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord mathrm">∣</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord mathrm">∣</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></span>. It is easy to show that surprise (or value) is a <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Lyapunov%2520function.html">Lyapunov function</a> for the policy </p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>V</mi></mrow><mo>˙</mo></mover><mo>=</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi>f</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>+</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo>×</mo><mi>W</mi><mo>=</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>⋅</mo><mi mathvariant="normal">Γ</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>V</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\dot{V} = \nabla V \cdot f = \nabla V \cdot \Gamma \cdot \nabla V + \nabla V \cdot \nabla \times W = \nabla V \cdot \Gamma \cdot \nabla V \geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201900000000001em;"></span><span class="strut bottom" style="height:1.11463em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>˙</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">+</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mrel">=</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">⋅</span><span class="mord mathrm">Γ</span><span class="mbin">⋅</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">≥</span><span class="mord mathrm">0</span></span></span></span></span></p></div>


</div>

</p>

</section>
</body>
</html>
